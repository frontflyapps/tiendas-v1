<mat-sidenav-container fullscreen>
  <!-- Vista movil menu -->
  <mat-sidenav #start [opened]='false' class='DrawerMobileView' mode='over'>
    <mat-list class='position-relative'>
      <mat-list-item>
        <mat-icon> person</mat-icon>
        &nbsp;
        <span class='mat-body-2' style='font-size: 19px'> {{ 'Hola' | translate }}, </span>
        &nbsp;
        <span *ngIf='loggedInUser' class='mat-body-2' style='font-size: 19px'>
          {{ loggedInUser?.name }}
        </span>

        <a *ngIf='!loggedInUser' class='mat-body-2' href='/my-account' style='font-size: 19px'>
          {{ 'Inicia Sesión' | translate }}
        </a>

        <span (click)='start.toggle()' class='sidebar-close-btn'>
          <mat-icon>close</mat-icon>
        </span>
      </mat-list-item>
    </mat-list>

    <mat-divider></mat-divider>

    <div class='sidebar-nav-items' fxLayout='column' fxLayoutAlign='start stretch'>
      <app-sidebar *ngFor='let item of navItems' [item]='item'></app-sidebar>
      <!--      <a mat-list-item class="link-nav-a" href="/become-a-seller">-->
      <!--        <mat-icon class="mr-3">card_membership</mat-icon>-->
      <!--        <span class="mat-body-2" style="font-size: 15px">{{ 'Crea tu negocio' | translate }}</span>-->
      <!--      </a>-->
      <div (click)='createYourBusiness()' class='link-nav-a'>
        <mat-icon class='mr-3'>card_membership</mat-icon>
        <span class='mat-body-2' style='font-size: 15px'>{{ 'Crea tu negocio' | translate }}</span>
      </div>
    </div>

    <mat-divider *ngFor='let item of [1, 2, 3, 4]'></mat-divider>

    <mat-list>
      <mat-list-item>
        <span class='mat-body-2' style='font-size: 19px'>
          {{ 'Configuración' | translate }}
        </span>
      </mat-list-item>
    </mat-list>

    <mat-nav-list>
      <a (click)='onShowProfile()' *ngIf='loggedInUser' fxLayoutAlign='start center' mat-list-item>
        <mat-icon>build</mat-icon>
        <span class='ml-3'>{{ 'Profile' | translate }}</span>
      </a>

      <a (click)='onShowMyContacts()' *ngIf='loggedInUser' fxLayoutAlign='start center' mat-list-item>
        <mat-icon>book</mat-icon>
        <span class='ml-3'>{{ 'Mis contactos' | translate }}</span>
      </a>

      <a (click)='onChangePass()' *ngIf='loggedInUser' fxLayoutAlign='start center' mat-list-item>
        <mat-icon>no_encryption</mat-icon>
        <span class='ml-3'>{{ 'Cambiar contraseña' | translate }}</span>
      </a>

      <a #langMenuTrigger='matMenuTrigger' [matMenuTriggerFor]='langMenu1' fxLayoutAlign='start center' mat-list-item>
        <img [src]='flag?.image' width='18' alt='flag' />
        <span class='ml-3 mat-body-2'>{{ flag?.name }}</span>
        <mat-icon class='mat-icon-sm caret cur-icon ml-auto'>arrow_drop_down</mat-icon>
      </a>

      <mat-menu #langMenu1='matMenu' [overlapTrigger]='false' class='app-dropdown' xPosition='before'>
        <button (click)='changeLang(flag)' *ngFor='let flag of flags' fxLayoutAlign='start center' mat-menu-item>
          <img [src]='flag?.image' alt='logo' width='18' /> <span class='ml-3 mat-body-2'>{{ flag?.name }}</span>
        </button>
      </mat-menu>

      <!--<a
        fxLayoutAlign="start center"
        mat-list-item
        [matMenuTriggerFor]="currencyMenu1"
        #currencyMenuTrigger="matMenuTrigger"
      >
        <span *ngIf="currency?.name == 'CUP'" style="font-size: 19px; margin-left: 7px"> &#36; </span>
        <span *ngIf="currency?.name == 'USD'" style="font-size: 19px; margin-left: 7px"> &#36; </span>
        <span class="ml-3 mat-body-2">{{ currency?.name }}</span>
        <mat-icon class="mat-icon-sm caret cur-icon ml-auto">arrow_drop_down</mat-icon>
      </a>-->

      <mat-menu #currencyMenu1='matMenu' [overlapTrigger]='false' class='app-dropdown' xPosition='before'>
        <button (click)='changeCurrency(cur)' *ngFor='let cur of currencies' fxLayoutAlign='start center' mat-menu-item>
          <span>{{ cur?.name }}</span>
        </button>
      </mat-menu>

      <a
        (click)='onGotoBackend()'
        *ngIf='loggedInUser && (loggedInUserService.isAdminOrOwnerUser() || loggedInUserService.isMessengerUser())'
        class='link-nav-a'
        mat-list-item
      >
        {{ 'Ir a la administración' | translate }}
      </a>

      <a (click)='onLogout()' *ngIf='loggedInUser' class='link-nav-a' mat-list-item>
        {{ 'Salir' | translate }}
      </a>
    </mat-nav-list>
  </mat-sidenav>

  <!-- Notifications -->
  <mat-sidenav
    #notificationBar
    [opened]='false'
    class='DrawerNotificationPanel'
    fixedInViewport
    mode='over'
    position='end'
  >
    <mat-list class='position-relative'>
      <mat-list-item>
        <mat-icon> notifications</mat-icon>
        &nbsp;
        <span class='mat-body-2' style='font-size: 19px'>
          {{ 'Notificaciones' | translate }}
        </span>

        <span (click)='notificationBar.toggle()' class='sidebar-close-btn'>
          <mat-icon>close</mat-icon>
        </span>
      </mat-list-item>
    </mat-list>

    <mat-divider></mat-divider>

    <app-panel-notifications (closePanel)='notificationBar.toggle()'></app-panel-notifications>
  </mat-sidenav>

  <!-- Todos excepto vista movil -->
  <div [class.py-2]='!loggedInUser' class='home-header' fxHide.lt-md>
    <div class='container-header' fxLayout='row wrap' fxLayoutAlign='space-between center'>
      <img
        alt='logo'
        class='Logo-img'
        fxHide.lt-md
        fxShow
        routerLink='/'
        src='assets/images/pymesbulevar/logo-r-white.png'
      />
      <button (click)='start.toggle()' fxHide fxShow.lt-md mat-icon-button>
        <mat-icon>menu</mat-icon>
      </button>

      <div class='search-form' fxFlex fxLayout='row' fxLayoutAlign='start center'>
        <div class='search-form' fxLayout='row' fxLayoutAlign='start center' fxLayoutGap='1rem'>
          <!-- ======== -->
          <!-- Location -->
          <div fxLayout='row' fxLayoutAlign='start center' fxLayoutGap='4px' id='nav-location'>
            <div class='nl-logo'>
              <mat-icon>room</mat-icon>
            </div>

            <div (click)='openSetLocation()' *ngIf='province' class='nl-titles' fxLayout='column'>
              <div class='nl-province'>{{ province?.name }}</div>
              <div class='nl-municipality'>{{ municipality?.name }}</div>
            </div>

            <div (click)='openSetLocation()' *ngIf='!province' class='nl-titles' fxLayout='column'>
              <div class='nl-province'>Enviar a...</div>
              <div class='nl-municipality'>Escoger lugar</div>
            </div>
          </div>

          <!-- ======== -->
          <!-- SEARCHING -->
          <div class='form-wrap' fxFlex='grow'>
            <input [formControl]='searchForm' placeholder="{{ 'Buscar en la tienda...' | translate }}" type='text' />
            <button (click)='onSearch()' class='btn-search'>
              <mat-icon>search</mat-icon>
            </button>
          </div>
        </div>
      </div>

      <div
        class='userWidgets'
        fxLayout='row'
        fxLayoutAlign='end center'
        fxLayoutAlign.xs='start center'
        ngClass.xs='w-100'
      >
        <a
          [routerLink]="['/pages/compare']"
          class='px-3'
          fxLayoutAlign='start center'
          matTooltip='Comparar productos'
          routerLinkActive='router-link-active'
        >
          <mat-icon *ngIf='compareItems.length' [matBadge]='compareItems.length' matBadgeColor='accent'
          >compare_arrows
          </mat-icon>

          <mat-icon *ngIf='!compareItems.length'>compare_arrows</mat-icon>
          <span fxHide fxShow='false'>{{ 'Comparar productos' | translate }}</span>
        </a>

        <!-- <a class="px-3" fxLayoutAlign="start center" mat-button [matMenuTriggerFor]="currencyMenu" #currencyMenuTrigger="matMenuTrigger">
          <span class="flag-menu-title">{{currency?.name}}</span>
          <mat-icon class="mat-icon-sm caret cur-icon">arrow_drop_down</mat-icon>
        </a>
        <mat-menu #currencyMenu="matMenu" [overlapTrigger]="false" xPosition="before" class="app-dropdown">
          <span>
            <button mat-menu-item *ngFor="let cur of currencies" (click)="changeCurrency(cur)">
              <span>{{cur?.name}}</span>
            </button>
          </span>
        </mat-menu>


        <a class="px-3" fxLayoutAlign="start center" mat-button [matMenuTriggerFor]="langMenu" #langMenuTrigger="matMenuTrigger">
          <img [src]="flag?.image" width="18">
          <mat-icon class="mat-icon-sm caret cur-icon">arrow_drop_down</mat-icon>
        </a>
        <mat-menu #langMenu="matMenu" [overlapTrigger]="false" xPosition="before" class="app-dropdown">
          <span>
            <button mat-menu-item *ngFor="let flag of flags" (click)="changeLang(flag)">
              <img [src]="flag?.image" width="18"> {{flag?.name}}
            </button>
          </span>
        </mat-menu> -->

        <!-- ================================ -->
        <!-- CART MENU -->
        <app-shopping-widgets></app-shopping-widgets>

        <!-- ================================ -->
        <!-- NOTIFICATIONS -->
        <a *ngIf='loggedInUser' class='px-3' fxLayoutAlign='start center' style='color: white'>
          <button (click)='notificationBar.toggle()' mat-icon-button>
            <mat-icon [matBadge]='notificationsService.getUnreadNotifications()' matBadgeColor='warn'
            >notifications
            </mat-icon>
          </button>
        </a>

        <!-- ================================ -->
        <!-- ACCOUNT MENU -->
        <a
          *ngIf='!loggedInUser'
          [routerLink]="['/my-account']"
          class='px-3'
          fxLayoutAlign='start center'
          fxShow='true'
          routerLinkActive='router-link-active'
        >
          <mat-icon>person</mat-icon>
          <span fxHide.xs>{{ 'Account' | translate }}</span>
        </a>

        <a
          #userMenuTrigger='matMenuTrigger'
          *ngIf='loggedInUser'
          [matMenuTriggerFor]='userMenu'
          class='px-0 pl-2'
          fxLayoutAlign='start center'
          fxShow
          mat-icon-button
        >
          <img
            *ngIf='!this.loggedInUser.avatar'
            alt='Profile'
            class='profileImage'
            src='assets/images/avatars/profile2.png'
          />
          <img
            *ngIf='this.loggedInUser.avatar'
            [src]='urlImage + loggedInUser.avatar'
            alt='Profile'
            class='profileImage'
          />
        </a>

        <mat-menu #userMenu='matMenu' [overlapTrigger]='false' class='app-dropdown' xPosition='before'>
          <button *ngIf='this.loggedInUser' mat-menu-item>
            <strong>{{ this.loggedInUser?.name }} {{ this.loggedInUser.lastName || '' }}</strong>
          </button>

          <button (click)='onShowProfile()' mat-menu-item>
            <mat-icon>build</mat-icon>
            <span class='mat-body-1'>{{ 'Profile' | translate }}</span>
          </button>

          <button (click)='onShowMyContacts()' mat-menu-item>
            <mat-icon>book</mat-icon>
            <span class='mat-body-1'>{{ 'Mis contactos' | translate }}</span>
          </button>

          <button
            (click)='onGotoBackend()'
            *ngIf='loggedInUser && (loggedInUserService.isAdminOrOwnerUser() || loggedInUserService.isMessengerUser())'
            mat-menu-item
          >
            <mat-icon>edit</mat-icon>
            <a id='linkNavBack' style='display: none'></a>
            <span class='mat-body-1'>{{ 'Administración' | translate }}</span>
          </button>

          <button (click)='onChangePass()' *ngIf='loggedInUser' mat-menu-item>
            <mat-icon>settings</mat-icon>
            <span class='mat-body-1'>{{ 'Cambie la contraseña' | translate }}</span>
          </button>

          <!-- ------------------------- -->
          <!-- NOTIFICATIONS -->
          <div (click)='createYourBusiness()' *ngIf='loggedInUser' mat-menu-item>
            <mat-icon>shopping_basket</mat-icon>
            <span class='mat-body-1'>{{ 'Crea tu negocio' | translate }}</span>
          </div>
          <!--          <a *ngIf="loggedInUser" mat-menu-item href="{{urlToCreateBusiness}}" target="_blank">-->
          <!--            <mat-icon>shopping_basket</mat-icon>-->
          <!--            <span class="mat-body-1">{{ 'Crea tu negocio' | translate }}</span>-->
          <!--          </a>-->

          <button (click)='onLogout()' mat-menu-item>
            <mat-icon>exit_to_app</mat-icon>
            <span class='mat-body-1'>{{ 'Logout' | translate }}</span>
          </button>
        </mat-menu>
      </div>
    </div>
  </div>

  <!--Home Header En vista movil -->
  <div class='home-header-2 p-2' fxHide fxShow.lt-md>
    <div fxLayout='column' fxLayoutAlign='start stretch'>
      <div fxLayout='row' fxLayoutAlign='space-between center' fxLayoutGap='gappx'>
        <div class='main-logo-container' fxLayoutAlign='start center'>
          <button (click)='start.toggle()' class='mr-2' mat-icon-button>
            <mat-icon>menu</mat-icon>
          </button>
          <img alt='logo' class='logo-img-main' routerLink='/' src='assets/images/pymesbulevar/logo-r-white.png' />
        </div>

        <div class='userWidgets m-0 p-0' fxLayoutAlign='start center'>
          <a
            *ngIf='!loggedInUser'
            [routerLink]="['/my-account']"
            class='px-3'
            fxLayoutAlign='start center'
            fxShow='true'
            routerLinkActive='router-link-active'
          >
            <mat-icon>person</mat-icon>
            <span fxHide.xs>{{ 'Account' | translate }}</span>
          </a>

          <app-shopping-widgets></app-shopping-widgets>

          <a *ngIf='loggedInUser' fxLayoutAlign='start center' style='color: white'>
            <button (click)='notificationBar.toggle()' mat-icon-button>
              <mat-icon [matBadge]='notificationsService.getUnreadNotifications()' matBadgeColor='warn'
              >notifications
              </mat-icon>
            </button>
          </a>
        </div>
      </div>

      <div fxLayout='row' fxLayoutAlign='center start' fxLayoutGap='gappx'>
        <div class='mobile-search' fxLayout='row' fxLayoutAlign='start center'>
          <input
            (keyup.enter)='onSearch()'
            [formControl]='searchForm'
            fxFlex
            placeholder="{{ 'Buscar en PymesBulevar...' | translate }}"
            type='search'
          />
          <button (click)='onSearch()'>
            <mat-icon>search</mat-icon>
          </button>
        </div>
      </div>

      <div
        class='showCategories'
        fxLayout='row'
        fxLayoutAlign.sm='center center'
        fxLayoutAlign.xs='start center'
        fxLayoutGap='gappx'
      >
        <!--        <a [routerLink]="['']"-->
        <!--           [routerLinkActiveOptions]="{ exact: true }"-->
        <!--           routerLinkActive="router-link-active"-->
        <!--           class="itemCategory"-->
        <!--           mat-button>{{ 'Inicio' | translate }}</a>-->

        <!-- QUITADO LINK DE BUSCAR DE TODOS LOS PRODUCTOS -->
        <!--        <a [routerLink]="['/products/search']" class="itemCategory" mat-button routerLinkActive="router-link-active">-->
        <!--          {{ 'Todos los productos' | translate }}</a-->
        <!--        >-->

        <!--        routerLinkActive="router-link-active"-->
        <a
          *ngFor='let category of categories'
          [queryParams]='{ CategoryId: category.id }'
          [routerLink]="['/products/search']"
          class='itemCategory'
          mat-button
          >{{ category.name | parseLang: utilsService.getLang() }}</a
        >
      </div>
    </div>
  </div>
  <div
    (click)='openSetLocation()'
    class='mobile-location'
    fxHide
    fxLayout='row'
    fxLayoutAlign='center center'
    fxLayoutGap='20'
    fxShow.lt-md
  >
    <div class='nl-logo' fxLayoutAlign='center center'>
      <mat-icon>room</mat-icon>
    </div>
    <div>{{ 'Escoger tienda...' | translate }}</div>
  </div>

  <div class='menu-container1'>
    <app-menu [_categories]='categories'></app-menu>
  </div>

  <router-outlet></router-outlet>

  <!--  <app-footer-two *ngIf="!url.includes('my-account')"></app-footer-two>-->
  <app-footer *ngIf="!url.includes('my-account')"></app-footer>
</mat-sidenav-container>

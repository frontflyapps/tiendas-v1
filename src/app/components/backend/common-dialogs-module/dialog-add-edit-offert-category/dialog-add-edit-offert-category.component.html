<div class="dialog-content-wrapper">

  <mat-toolbar class="mb-2" matDialogTitle color="primary" id="toolbarHeader">
    <mat-toolbar-row fxLayoutAlign="space-between center">
      <span class="mat-title mb-0">{{'Oferta por categoría'|translate}}</span>
      <button mat-icon-button (click)="dialogRef.close()" aria-label="Close dialog">
        <mat-icon>close</mat-icon>
      </button>
    </mat-toolbar-row>
  </mat-toolbar>

  <div mat-dialog-content class="my-dialog-content">
    <form [formGroup]="form">
      <div fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="gappx">
        <p class="uppercase mat-body-2">
          Seleccione el nombre de su oferta
        </p>

        <mat-form-field class="mt-2" appearance="outline">
          <mat-label>{{'Name'|translate}}</mat-label>
          <input required type="text" [formControl]="form.controls['name']" matInput placeholder="{{'Name'|translate}}">
          <mat-icon class="greyIcon" matSuffix>unarchive</mat-icon>
          <mat-error *ngIf="form.controls['name'].hasError('required')">
            {{'Name'|translate}} <strong>{{'is required'|translate}}</strong>
          </mat-error>
        </mat-form-field>

        <p class="uppercase mat-body-2 mb-2">
          Seleccione las categorías de los productos a los cuales se le va a aplicar la oferta.
        </p>

        <mat-form-field class="mt-2" appearance="outline">
          <mat-label>{{'Categorías'|translate}}</mat-label>
          <mat-select [formControl]="form.controls['CategoryIds']" multiple>
            <mat-option *ngFor="let category of allCategories" [value]="category">
              {{category.name['es']}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <ng-container *ngIf="form.get('CategoryIds').value && form.get('CategoryIds').value.length">
          <p class="uppercase mat-body-2">
            Categorías
          </p>

          <div fxLayout="row wrap" class="py-3" fxLayoutAlign="start start" fxLayoutGap="gappx">
            <mat-chip-list aria-label="Seleccion de categorías">
              <mat-chip *ngFor="let category of form.get('CategoryIds').value" (removed)="removeCategory(category)">
                {{category.name['es']}}
                <button class="clearChipBtn" style="color: #757575;background-color: #bdbdbd;" (click)="removeCategory(category)"
                  mat-icon-button>
                  <mat-icon>clear</mat-icon>
                </button>
              </mat-chip>
            </mat-chip-list>
          </div>
        </ng-container>

        <p class="uppercase mat-body-2">
          Valor de descuento a aplicar
        </p>

        <div fxLayout="row wrap" fxLayoutAlign="start center" fxLayoutGap="gappx">
          <mat-form-field class="mt-2" appearance="outline">
            <mat-label>{{'Valor de descuento'|translate}}</mat-label>
            <input required type="number" [formControl]="form.controls['value']" matInput placeholder="{{'Valor de descuento'|translate}}">
          </mat-form-field>
          <mat-checkbox [formControl]="form.controls['isPercent']" class="ml-3" style="padding-bottom: 21.5px;">Aplicar en %</mat-checkbox>
        </div>

        <p class="uppercase mat-body-2">
          {{"Rango de tiempo en el que tiene validez la oferta"|translate}}
        </p>

        <div fxLayout="row wrap" class="mt-2" fxLayoutAlign="space-between start" fxLayoutGap="gappx">
          <mat-form-field appearance="outline" fxFlex="48" fxFlex.lt-md="100">
            <mat-label>{{'Inicio'|translate}}</mat-label>
            <input matInput [min]="minDate1" [matDatepicker]="picker" [formControl]="form.controls['startDate']">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
          <mat-form-field appearance="outline" fxFlex="48" fxFlex.lt-md="100">
            <mat-label>{{'Fin'|translate}}</mat-label>
            <input matInput [min]="minDate1" [matDatepicker]="picker2" [formControl]="form.controls['endDate']">
            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
            <mat-datepicker #picker2></mat-datepicker>
          </mat-form-field>
        </div>
      </div>

    </form>
  </div>

  <div mat-dialog-actions fxLayout="row" fxLayoutAlign="end start">
    <button mat-flat-button (click)="onSave()" [disabled]="this.form.invalid" color="primary">{{'Save'|translate}}</button>

  </div>

</div>
